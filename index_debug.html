<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Serious editor</title>
<style>
*{ margin: 0; padding: 0; border: 0; -o-user-select:none; -ms-user-select:none; -khtml-user-select:none; -webkit-user-select:none; -moz-user-select:none;} 
html{ overflow:hidden; width:100%; height:100%; }
body { font-family:monospace; background:#222; font-size:12px; color:#fff;}
#debug { position:absolute; top:10px; left:10px; width:200px; height:40px; pointer-events:none;}
#canvas { position:absolute; pointer-events:auto; width:100%; height:100%;}
</style>
<link rel="shortcut icon" href="favicon.ico">
<script type="text/javascript" src="js/libs/three.min.js"></script>
<script type="text/javascript" src="build/seriously.min.js"></script>
<script type="text/javascript" src="src/UIsr.js"></script>
<script type="text/javascript" src="src/seriousEditor.js"></script>
<script type="text/javascript" src="js/V.3d.js"></script>
</head>

<body>
<canvas id='canvas'></canvas>
<div id='debug'>Seriously Editor<br>version 0.7 alpha</div>
<script>

var bgcolor = '333333';
document.body.style.background = '#'+ bgcolor;
var canvas = document.getElementById('canvas');
var debug = document.getElementById('debug');

// init three viewer
var v = new V.View(90, 90, 25, 60, null);

// init seriously editor
var s = new Serious.Editor( true, v.canvas );

// create three textures
s.textures['tx1'] = v.addSeriousTexture();
s.textures['tx2'] = v.addSeriousTexture();
s.textures['tx3'] = v.addSeriousTexture();

s.texture_default = 'tx1';

// sources
s.add('image', {n:'s1', src:'images/akira.jpg'});
s.add('image', {n:'s2', src:'images/moeb.jpg'});
s.add('image', {n:'s3', src:'images/rank.jpg'}, 3);
s.add('image', {n:'s4', src:'images/gime.jpg'});

// effects
s.add('split', {n:'f1'});
s.add('lumakey', {n:'f2', clipBlack:0.2});
s.add('brightness-contrast', {n:'f3'});
s.add('blend', {n:'f4'});
s.add('checkerboard', {n:'f5'});

// target
s.add('texture-3D', { n:'t0', texture: 'tx1' }  );
s.add('texture-3D', { n:'t1', texture: 'tx2' }  );
s.add('texture-3D', { n:'t2', texture: 'tx3' }  );

//serious.addOnAll('texture-3D', { n:'t3', texture: tx1 }  );

// add effect on layer 6
s.add('bleach-bypass', {n:'f2'}, 6);
s.add('brightness-contrast', {n:'f3'}, 6);

// add links
s.addLink('s1', 'f2');
s.addLink('f2', 't1');



var m0 = v.addPlane(s.textures['tx1']);
var m1 = v.addPlane(s.textures['tx2']);
var m2 = v.addPlane(s.textures['tx3']);

m0.position.x = -12;
m2.position.x = 12;

s.refreshOnly(0, true);

loop();

function loop(){
    requestAnimationFrame( loop );

    //serious.update();

    v.renderer.setClearColor( ('0x'+bgcolor)*1, 1 );
    v.render();
}

</script>
</body>
</html>